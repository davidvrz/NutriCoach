{% extends "base.html" %}

{% block title %}Planes Alimenticios Predefinidos - NutriCoach{% endblock %}

{% block content %}
<div class="secondary-nav">
    <div class="breadcrumb">
        <span class="breadcrumb-item"><a href="{{ url_for('cliente.lista_clientes') }}">Clientes</a></span>
        <span class="breadcrumb-item">Planes Predefinidos</span>
    </div>
</div>

<div class="planes-header">
    <h1>Planes Alimenticios Predefinidos</h1>
    <a href="{{ url_for('plan.nuevo_plan_predefinido') }}" class="btn-primary">+ Crear nuevo plan</a>
</div>

{% if planes %}
<div class="planes-grid">
    {% for plan in planes %}
    <div class="plan-card">
        <div class="plan-header">
            <h3>{{ plan.nombre }}</h3>
            <span class="plan-tipo">{{ plan.tipo|capitalize }}</span>
        </div>
        <div class="plan-body">
            <p class="plan-desc">{{ plan.descripcion }}</p>

            <div class="plan-comidas-resumen">
                <h4>Comidas incluidas:</h4>
                <ul>
                    {% for comida_nombre, comida in plan.comidas.items() %}
                    <li>{{ comida_nombre|capitalize }}: {{ comida.descripcion|truncate(30) }}</li>
                    {% endfor %}
                </ul>
            </div>

            <div class="plan-metadata">
                <span class="plan-fecha">Actualizado: {{ plan.actualizado.strftime("%d/%m/%Y") }}</span>
            </div>
        </div>
        <div class="plan-actions">
            <a href="{{ url_for('plan.editar_plan_predefinido', safe_id=plan.safe_id) }}" class="btn-editar">Editar</a>
            <a href="{{ url_for('plan.eliminar_plan_predefinido', safe_id=plan.safe_id) }}" class="btn-eliminar"
                data-confirm="¿Estás seguro de que deseas eliminar este plan predefinido? Esta acción no se puede deshacer.">
                Eliminar
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="planes-empty">
    <p>Aún no has creado ningún plan alimenticio predefinido.</p>
    <p>Los planes predefinidos te permiten crear plantillas reutilizables para aplicarlas rápidamente en tus planes
        diarios.</p>
</div>
{% endif %}
{% endblock %}

{% block extra_css %}
<style>
    .planes-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
    }

    .planes-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }

    .plan-card {
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }

    .plan-header {
        background-color: var(--primary-light);
        padding: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .plan-header h3 {
        margin: 0;
        color: var(--primary-dark);
    }

    .plan-tipo {
        background-color: var(--primary-color);
        color: white;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
    }

    .plan-body {
        padding: 15px;
    }

    .plan-desc {
        color: #666;
        margin-bottom: 15px;
    }

    .plan-comidas-resumen h4 {
        font-size: 1rem;
        margin: 10px 0;
        color: var(--primary-color);
    }

    .plan-comidas-resumen ul {
        margin: 0;
        padding-left: 20px;
        color: #555;
    }

    .plan-comidas-resumen li {
        margin-bottom: 5px;
        font-size: 0.9rem;
    }

    .plan-metadata {
        font-size: 0.8rem;
        color: #999;
        margin-top: 15px;
        text-align: right;
    }

    .plan-actions {
        display: flex;
        justify-content: space-between;
        padding: 10px 15px;
        background-color: #f9f9f9;
        border-top: 1px solid #eee;
    }

    .planes-empty {
        text-align: center;
        padding: 40px 20px;
        border: 2px dashed #ddd;
        border-radius: 8px;
        color: #666;
    }

    .planes-empty p:first-child {
        font-size: 1.2rem;
        margin-bottom: 10px;
    }
</style>
{% endblock %}